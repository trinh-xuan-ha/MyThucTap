;/*FB_PKG_DELIM*/

__d("LSGetFirstAvailableAdminMessageCTAID",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(a){return b.sequence([function(a){return b.db.table(27).fetchDesc([[[]],"ctaId"]).next().then(function(a,d){var e=a.done;a=a.value;return e?c[0]=b.i64.cast([0,1]):(d=a.item,c[0]=b.i64.add(d.ctaId,b.i64.cast([0,1])))})},function(a){return d[0]=c[0]}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxGetFirstAvailableAdminMessageCTAIDStoredProcedure";e.exports=a}),null);
__d("LSApplyAdminMessageCTA",["LSArrayGetObjectAt","LSDeserializeFromJsonIntoDictionaryV2.nop","LSGetFirstAvailableAdminMessageCTAID"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(a){return c.storedProcedure(b("LSGetFirstAvailableAdminMessageCTAID")).then(function(a){return a=a,d[0]=a[0],a})},function(b){return c.db.table(27).put({threadKey:a[0],messageId:a[2],ctaId:d[0],timestampMs:a[1],adClientToken:a[5],adPreferenceUrl:a[6],adHelpUrl:a[7],showAdChoiceIcon:a[8],title:a[3],actionUrl:a[9],adminMessageNicknameParticipantId:a[10],targetId:a[11],targetTitle:a[12]})},function(e){return c.filter(c.db.table(12).fetch([[[a[2]]],"messageId"]),function(b){return a[2]===b.messageId&&c.i64.eq(a[0],b.threadKey)}).next().then(function(a,e){var f=a.done;a=a.value;return f?d[1]=void 0:(e=a.item,c.sequence([function(a){return d[7]=e.metadataDataclass,d[7]!==void 0?c.sequence([function(a){return c.nativeOperation(b("LSDeserializeFromJsonIntoDictionaryV2.nop"),d[7]).then(function(a){return a=a,d[8]=a[0],a})},function(a){return d[9]=new c.Map(),d[54]="sticker",d[10]=d[8].get(d[54]),d[8],d[10]?d[11]=!1:d[11]=!0,d[11]?0:(d[10]?d[76]=!1:d[76]=!0,d[76]?d[77]=void 0:(d[78]=new c.Map(),d[83]="sticker_pack_id",d[79]=d[10].get(d[83]),d[10],d[79]!==void 0?d[78].set(d[83],d[79]):0,d[84]="sticker_id",d[80]=d[10].get(d[84]),d[10],d[80]!==void 0?d[78].set(d[84],d[80]):0,d[85]="avatar_style",d[81]=d[10].get(d[85]),d[10],d[81]!==void 0?d[78].set(d[85],d[81]):0,d[86]="avatar_revision_id",d[82]=d[10].get(d[86]),d[10],d[82]!==void 0?(d[82]!==void 0?d[87]=c.i64.from_string(d[82]):d[87]=void 0,d[78].set(d[86],d[87])):0,d[77]=d[78]),d[9].set(d[54],d[77])),d[55]="word_effects",d[12]=d[8].get(d[55]),d[8],d[12]?d[13]=!1:d[13]=!0,d[13]?c.resolve():c.sequence([function(a){return d[12]?d[76]=!1:d[76]=!0,d[76]?c.resolve(d[77]=void 0):c.sequence([function(a){return d[78]=new c.Map(),d[85]="magic_word_offsets",d[79]=d[12].get(d[85]),d[12],d[79]?d[80]=!1:d[80]=!0,d[80]?c.resolve():c.sequence([function(a){return d[88]=c.createArray(),d[89]=c.i64.of_int32(d[79].length),c.i64.gt(d[89],c.i64.cast([0,0]))?c.loopAsync(d[89],function(a){return d[90]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[79],d[90]).then(function(a){return a=a,d[91]=a[0],d[92]=a[1],a})},function(a){return d[93]=(d[88].push(d[91]),d[88])}])}):c.resolve()},function(a){return d[78].set(d[85],d[88])}])},function(a){return d[86]="magic_word_lengths",d[81]=d[12].get(d[86]),d[12],d[81]?d[82]=!1:d[82]=!0,d[82]?c.resolve():c.sequence([function(a){return d[88]=c.createArray(),d[89]=c.i64.of_int32(d[81].length),c.i64.gt(d[89],c.i64.cast([0,0]))?c.loopAsync(d[89],function(a){return d[90]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[81],d[90]).then(function(a){return a=a,d[91]=a[0],d[92]=a[1],a})},function(a){return d[93]=(d[88].push(d[91]),d[88])}])}):c.resolve()},function(a){return d[78].set(d[86],d[88])}])},function(a){return d[87]="magic_word_emojis",d[83]=d[12].get(d[87]),d[12],d[83]?d[84]=!1:d[84]=!0,d[84]?c.resolve():c.sequence([function(a){return d[83]?d[88]=!1:d[88]=!0,d[88]?c.resolve(d[89]=void 0):c.sequence([function(a){return d[90]=c.createArray(),d[91]=c.i64.of_int32(d[83].length),c.i64.gt(d[91],c.i64.cast([0,0]))?c.loopAsync(d[91],function(a){return d[92]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[83],d[92]).then(function(a){return a=a,d[93]=a[0],d[94]=a[1],a})},function(a){return d[95]=(d[90].push(d[93]),d[90])}])}):c.resolve()},function(a){return d[89]=d[90]}])},function(a){return d[78].set(d[87],d[89])}])},function(a){return d[77]=d[78]}])},function(a){return d[9].set(d[55],d[77])}])},function(a){return d[56]="ig_avatar_sticker",d[14]=d[8].get(d[56]),d[8],d[14]?d[15]=!1:d[15]=!0,d[15]?0:(d[14]?d[76]=!1:d[76]=!0,d[76]?d[77]=void 0:(d[78]=new c.Map(),d[80]="is_avatar_sticker",d[79]=d[14].get(d[80]),d[14],d[79]!==void 0?d[78].set(d[80],d[79]):0,d[77]=d[78]),d[9].set(d[56],d[77])),d[57]="power_up",d[16]=d[8].get(d[57]),d[8],d[16]?d[17]=!1:d[17]=!0,d[17]?0:(d[16]?d[76]=!1:d[76]=!0,d[76]?d[77]=void 0:(d[78]=new c.Map(),d[80]="power_up_style",d[79]=d[16].get(d[80]),d[16],d[79]!==void 0?d[78].set(d[80],d[79]):0,d[77]=d[78]),d[9].set(d[57],d[77])),d[58]="ai_bot",d[18]=d[8].get(d[58]),d[8],d[18]?d[19]=!1:d[19]=!0,d[19]?c.resolve():c.sequence([function(a){return d[18]?d[76]=!1:d[76]=!0,d[76]?c.resolve(d[77]=void 0):c.sequence([function(a){return d[78]=new c.Map(),d[97]="response_id",d[79]=d[18].get(d[97]),d[18],d[79]!==void 0?d[78].set(d[97],d[79]):0,d[98]="bot_action",d[80]=d[18].get(d[98]),d[18],d[80]!==void 0?d[78].set(d[98],d[80]):0,d[99]="sentiment",d[81]=d[18].get(d[99]),d[18],d[81]!==void 0?d[78].set(d[99],d[81]):0,d[100]="sentiment_intensity",d[82]=d[18].get(d[100]),d[18],d[82]!==void 0?d[78].set(d[100],d[82]):0,d[101]="bot_action_int",d[83]=d[18].get(d[101]),d[18],c.i64.neq(d[83],void 0)?d[78].set(d[101],d[83]):0,d[102]="sentiment_int",d[84]=d[18].get(d[102]),d[18],c.i64.neq(d[84],void 0)?d[78].set(d[102],d[84]):0,d[103]="sentiment_intensity_int",d[85]=d[18].get(d[103]),d[18],c.i64.neq(d[85],void 0)?d[78].set(d[103],d[85]):0,d[104]="bot_invocation_message_id",d[86]=d[18].get(d[104]),d[18],d[86]!==void 0?d[78].set(d[104],d[86]):0,d[105]="bot_response_id",d[87]=d[18].get(d[105]),d[18],d[87]!==void 0?d[78].set(d[105],d[87]):0,d[106]="bot_invocation_message_otid",d[88]=d[18].get(d[106]),d[18],d[88]!==void 0?d[78].set(d[106],d[88]):0,d[107]="bot_invocation_logging_id",d[89]=d[18].get(d[107]),d[18],d[89]!==void 0?d[78].set(d[107],d[89]):0,d[108]="is_error",d[90]=d[18].get(d[108]),d[18],d[90]!==void 0?d[78].set(d[108],d[90]):0,d[109]="bot_subscription_id",d[91]=d[18].get(d[109]),d[18],d[91]!==void 0?(d[91]!==void 0?d[114]=c.i64.from_string(d[91]):d[114]=void 0,d[78].set(d[109],d[114])):0,d[110]="bot_subscription_product_type",d[92]=d[18].get(d[110]),d[18],d[92]!==void 0?d[78].set(d[110],d[92]):0,d[111]="bot_response_product_type",d[93]=d[18].get(d[111]),d[18],d[93]!==void 0?d[78].set(d[111],d[93]):0,d[112]="original_prompt_text",d[94]=d[18].get(d[112]),d[18],d[94]!==void 0?d[78].set(d[112],d[94]):0,d[113]="bot_response_additional_message_otids",d[95]=d[18].get(d[113]),d[18],d[95]?d[96]=!1:d[96]=!0,d[96]?c.resolve():c.sequence([function(a){return d[95]?d[114]=!1:d[114]=!0,d[114]?c.resolve(d[115]=void 0):c.sequence([function(a){return d[116]=c.createArray(),d[117]=c.i64.of_int32(d[95].length),c.i64.gt(d[117],c.i64.cast([0,0]))?c.loopAsync(d[117],function(a){return d[118]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[95],d[118]).then(function(a){return a=a,d[119]=a[0],d[120]=a[1],a})},function(a){return d[121]=(d[116].push(d[119]),d[116])}])}):c.resolve()},function(a){return d[115]=d[116]}])},function(a){return d[78].set(d[113],d[115])}])},function(a){return d[77]=d[78]}])},function(a){return d[9].set(d[58],d[77])}])},function(a){return d[59]="pobox",d[20]=d[8].get(d[59]),d[8],d[20]?d[21]=!1:d[21]=!0,d[21]?0:(d[20]?d[76]=!1:d[76]=!0,d[76]?d[77]=void 0:(d[78]=new c.Map(),d[81]="pobox_fbid",d[79]=d[20].get(d[81]),d[20],d[79]!==void 0?(d[79]!==void 0?d[83]=c.i64.from_string(d[79]):d[83]=void 0,d[78].set(d[81],d[83])):0,d[82]="pobox_id",d[80]=d[20].get(d[82]),d[20],d[80]!==void 0?d[78].set(d[82],d[80]):0,d[77]=d[78]),d[9].set(d[59],d[77])),d[60]="video",d[22]=d[8].get(d[60]),d[8],d[22]?d[23]=!1:d[23]=!0,d[23]?0:(d[22]?d[76]=!1:d[76]=!0,d[76]?d[77]=void 0:(d[78]=new c.Map(),d[80]="unified_upload_mos",d[79]=d[22].get(d[80]),d[22],d[79]!==void 0?d[78].set(d[80],d[79]):0,d[77]=d[78]),d[9].set(d[60],d[77])),d[61]="text_translation",d[24]=d[8].get(d[61]),d[8],d[24]?d[25]=!1:d[25]=!0,d[25]?0:(d[24]?d[76]=!1:d[76]=!0,d[76]?d[77]=void 0:(d[78]=new c.Map(),d[82]="translated_text",d[79]=d[24].get(d[82]),d[24],d[79]!==void 0?d[78].set(d[82],d[79]):0,d[83]="text_dialect",d[80]=d[24].get(d[83]),d[24],d[80]!==void 0?d[78].set(d[83],d[80]):0,d[84]="translated_text_dialect",d[81]=d[24].get(d[84]),d[24],d[81]!==void 0?d[78].set(d[84],d[81]):0,d[77]=d[78]),d[9].set(d[61],d[77])),d[62]="memories",d[26]=d[8].get(d[62]),d[8],d[26]?d[27]=!1:d[27]=!0,d[27]?0:(d[26]?d[76]=!1:d[76]=!0,d[76]?d[77]=void 0:(d[78]=new c.Map(),d[82]="original_message_id",d[79]=d[26].get(d[82]),d[26],d[79]!==void 0?d[78].set(d[82],d[79]):0,d[83]="original_message_creation_ts",d[80]=d[26].get(d[83]),d[26],d[80]!==void 0?(d[80]!==void 0?d[85]=c.i64.from_string(d[80]):d[85]=void 0,d[78].set(d[83],d[85])):0,d[84]="memory_server_id",d[81]=d[26].get(d[84]),d[26],d[81]!==void 0?(d[81]!==void 0?d[85]=c.i64.from_string(d[81]):d[85]=void 0,d[78].set(d[84],d[85])):0,d[77]=d[78]),d[9].set(d[62],d[77])),d[63]="command",d[28]=d[8].get(d[63]),d[8],d[28]?d[29]=!1:d[29]=!0,d[29]?0:(d[28]?d[76]=!1:d[76]=!0,d[76]?d[77]=void 0:(d[78]=new c.Map(),d[80]="command_type",d[79]=d[28].get(d[80]),d[28],c.i64.neq(d[79],void 0)?d[78].set(d[80],d[79]):0,d[77]=d[78]),d[9].set(d[63],d[77])),d[64]="admin_message",d[30]=d[8].get(d[64]),d[8],d[30]?d[31]=!1:d[31]=!0,d[31]?0:(d[30]?d[76]=!1:d[76]=!0,d[76]?d[77]=void 0:(d[78]=new c.Map(),d[89]="ad_client_token",d[79]=d[30].get(d[89]),d[30],d[79]!==void 0?d[78].set(d[89],d[79]):0,d[90]="ad_preference_url",d[80]=d[30].get(d[90]),d[30],d[80]!==void 0?d[78].set(d[90],d[80]):0,d[91]="ad_help_url",d[81]=d[30].get(d[91]),d[30],d[81]!==void 0?d[78].set(d[91],d[81]):0,d[92]="show_ad_choice_icon",d[82]=d[30].get(d[92]),d[30],d[82]!==void 0?d[78].set(d[92],d[82]):0,d[93]="title",d[83]=d[30].get(d[93]),d[30],d[83]!==void 0?d[78].set(d[93],d[83]):0,d[94]="action_url",d[84]=d[30].get(d[94]),d[30],d[84]!==void 0?d[78].set(d[94],d[84]):0,d[95]="admin_message_nickname_participant_id",d[85]=d[30].get(d[95]),d[30],d[85]!==void 0?(d[85]!==void 0?d[99]=c.i64.from_string(d[85]):d[99]=void 0,d[78].set(d[95],d[99])):0,d[96]="target_id",d[86]=d[30].get(d[96]),d[30],d[86]!==void 0?(d[86]!==void 0?d[99]=c.i64.from_string(d[86]):d[99]=void 0,d[78].set(d[96],d[99])):0,d[97]="target_title",d[87]=d[30].get(d[97]),d[30],d[87]!==void 0?d[78].set(d[97],d[87]):0,d[98]="identifier_name",d[88]=d[30].get(d[98]),d[30],d[88]!==void 0?d[78].set(d[98],d[88]):0,d[77]=d[78]),d[9].set(d[64],d[77])),d[65]="misinfo_metadata",d[32]=d[8].get(d[65]),d[8],d[32]?d[33]=!1:d[33]=!0,d[33]?0:(d[32]?d[76]=!1:d[76]=!0,d[76]?d[77]=void 0:(d[78]=new c.Map(),d[81]="has_misinfo",d[79]=d[32].get(d[81]),d[32],d[79]!==void 0?d[78].set(d[81],d[79]):0,d[82]="misinfo_source",d[80]=d[32].get(d[82]),d[32],d[80]!==void 0?d[78].set(d[82],d[80]):0,d[77]=d[78]),d[9].set(d[65],d[77])),d[66]="forwarded_message",d[34]=d[8].get(d[66]),d[8],d[34]?d[35]=!1:d[35]=!0,d[35]?0:(d[34]?d[76]=!1:d[76]=!0,d[76]?d[77]=void 0:(d[78]=new c.Map(),d[81]="forwarded_from_thread_name",d[79]=d[34].get(d[81]),d[34],d[79]!==void 0?d[78].set(d[81],d[79]):0,d[82]="forwarded_from_thread_url",d[80]=d[34].get(d[82]),d[34],d[80]!==void 0?d[78].set(d[82],d[80]):0,d[77]=d[78]),d[9].set(d[66],d[77])),d[67]="ai_metadata",d[36]=d[8].get(d[67]),d[8],d[36]?d[37]=!1:d[37]=!0,d[37]?0:(d[36]?d[76]=!1:d[76]=!0,d[76]?d[77]=void 0:(d[78]=new c.Map(),d[83]="is_ai_generated",d[79]=d[36].get(d[83]),d[36],d[79]!==void 0?d[78].set(d[83],d[79]):0,d[84]="gen_ai_integrity_ent_id",d[80]=d[36].get(d[84]),d[36],d[80]!==void 0?(d[80]!==void 0?d[87]=c.i64.from_string(d[80]):d[87]=void 0,d[78].set(d[84],d[87])):0,d[85]="ai_product",d[81]=d[36].get(d[85]),d[36],d[81]!==void 0?d[78].set(d[85],d[81]):0,d[86]="original_prompt_text",d[82]=d[36].get(d[86]),d[36],d[82]!==void 0?d[78].set(d[86],d[82]):0,d[77]=d[78]),d[9].set(d[67],d[77])),d[68]="encrypted_message",d[38]=d[8].get(d[68]),d[8],d[38]?d[39]=!1:d[39]=!0,d[39]?c.resolve():c.sequence([function(a){return d[38]?d[76]=!1:d[76]=!0,d[76]?c.resolve(d[77]=void 0):c.sequence([function(a){return d[78]=new c.Map(),d[86]="thread_id",d[79]=d[38].get(d[86]),d[38],d[79]!==void 0?d[78].set(d[86],d[79]):0,d[87]="offline_threading_id",d[80]=d[38].get(d[87]),d[38],d[80]!==void 0?d[78].set(d[87],d[80]):0,d[88]="toplevel_payload",d[81]=d[38].get(d[88]),d[38],d[81]?d[82]=!1:d[82]=!0,d[82]?0:(d[91]=new c.Map(),d[97]="encrypted_payload",d[92]=d[81].get(d[97]),d[81],d[92]!==void 0?d[91].set(d[97],d[92]):0,d[98]="payloadTimestampMs",d[93]=d[81].get(d[98]),d[81],d[93]!==void 0?d[91].set(d[98],c.i64.from_string(d[93])):0,d[99]="encryption_version",d[94]=d[81].get(d[99]),d[81],c.i64.neq(d[94],void 0)?d[91].set(d[99],d[94]):0,d[100]="epoch_id",d[95]=d[81].get(d[100]),d[81],d[95]!==void 0?d[91].set(d[100],c.i64.from_string(d[95])):0,d[101]="epoch_anon_id",d[96]=d[81].get(d[101]),d[81],d[96]!==void 0?d[91].set(d[101],d[96]):0,d[78].set(d[88],d[91])),d[89]="supplemental_payloads",d[83]=d[38].get(d[89]),d[38],d[83]?d[84]=!1:d[84]=!0,d[84]?c.resolve():c.sequence([function(a){return d[91]=c.createArray(),d[92]=c.i64.of_int32(d[83].length),c.i64.gt(d[92],c.i64.cast([0,0]))?c.loopAsync(d[92],function(a){return d[93]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[83],d[93]).then(function(a){return a=a,d[94]=a[0],d[95]=a[1],a})},function(a){return d[96]=new c.Map(),d[101]="encrypted_supplemental_key",d[97]=d[94].get(d[101]),d[94],d[97]!==void 0?d[96].set(d[101],d[97]):0,d[102]="supplemental_key_ciphertext",d[98]=d[94].get(d[102]),d[94],d[98]!==void 0?d[96].set(d[102],d[98]):0,d[103]="encrypted_supplemental_payload",d[99]=d[94].get(d[103]),d[94],d[99]?d[100]=!1:d[100]=!0,d[100]?0:(d[104]=new c.Map(),d[110]="encrypted_payload",d[105]=d[99].get(d[110]),d[99],d[105]!==void 0?d[104].set(d[110],d[105]):0,d[111]="payloadTimestampMs",d[106]=d[99].get(d[111]),d[99],d[106]!==void 0?d[104].set(d[111],c.i64.from_string(d[106])):0,d[112]="encryption_version",d[107]=d[99].get(d[112]),d[99],c.i64.neq(d[107],void 0)?d[104].set(d[112],d[107]):0,d[113]="epoch_id",d[108]=d[99].get(d[113]),d[99],d[108]!==void 0?d[104].set(d[113],c.i64.from_string(d[108])):0,d[114]="epoch_anon_id",d[109]=d[99].get(d[114]),d[99],d[109]!==void 0?d[104].set(d[114],d[109]):0,d[96].set(d[103],d[104])),d[104]=(d[91].push(d[96]),d[91])}])}):c.resolve()},function(a){return d[78].set(d[89],d[91])}])},function(a){return d[90]="is_open_eb",d[85]=d[38].get(d[90]),d[38],d[85]!==void 0?d[78].set(d[90],d[85]):0,d[77]=d[78]}])},function(a){return d[9].set(d[68],d[77])}])},function(a){return d[69]="rich_text",d[40]=d[8].get(d[69]),d[8],d[40]?d[41]=!1:d[41]=!0,d[41]?0:(d[40]?d[76]=!1:d[76]=!0,d[76]?d[77]=void 0:(d[78]=new c.Map(),d[80]="rich_text_format_type",d[79]=d[40].get(d[80]),d[40],c.i64.neq(d[79],void 0)?d[78].set(d[80],d[79]):0,d[77]=d[78]),d[9].set(d[69],d[77])),d[70]="content_logging_metadata",d[42]=d[8].get(d[70]),d[8],d[42]?d[43]=!1:d[43]=!0,d[43]?c.resolve():c.sequence([function(a){return d[42]?d[76]=!1:d[76]=!0,d[76]?c.resolve(d[77]=void 0):c.sequence([function(a){return d[78]=new c.Map(),d[83]="containing_post",d[79]=d[42].get(d[83]),d[42],d[79]?d[80]=!1:d[80]=!0,d[80]?c.resolve():c.sequence([function(a){return d[79]?d[85]=!1:d[85]=!0,d[85]?c.resolve(d[86]=void 0):c.sequence([function(a){return d[87]=new c.Map(),d[95]="key_type",d[88]=d[79].get(d[95]),d[79],d[88]!==void 0?d[87].set(d[95],d[88]):0,d[96]="fb_post_type",d[89]=d[79].get(d[96]),d[79],d[89]?d[90]=!1:d[90]=!0,d[90]?c.resolve():c.sequence([function(a){return d[89]?d[99]=!1:d[99]=!0,d[99]?c.resolve(d[100]=void 0):c.sequence([function(a){return d[101]=c.createArray(),d[102]=c.i64.of_int32(d[89].length),c.i64.gt(d[102],c.i64.cast([0,0]))?c.loopAsync(d[102],function(a){return d[103]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[89],d[103]).then(function(a){return a=a,d[104]=a[0],d[105]=a[1],a})},function(a){return d[106]=(d[101].push(d[104]),d[101])}])}):c.resolve()},function(a){return d[100]=d[101]}])},function(a){return d[87].set(d[96],d[100])}])},function(a){return d[97]="photos",d[91]=d[79].get(d[97]),d[79],d[91]?d[92]=!1:d[92]=!0,d[92]?c.resolve():c.sequence([function(a){return d[91]?d[99]=!1:d[99]=!0,d[99]?c.resolve(d[100]=void 0):c.sequence([function(a){return d[101]=c.createArray(),d[102]=c.i64.of_int32(d[91].length),c.i64.gt(d[102],c.i64.cast([0,0]))?c.loopAsync(d[102],function(a){return d[103]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[91],d[103]).then(function(a){return a=a,d[104]=a[0],d[105]=a[1],a})},function(a){return d[106]=new c.Map(),d[108]="key_type",d[107]=d[104].get(d[108]),d[104],d[107]!==void 0?d[106].set(d[108],d[107]):0,d[109]=(d[101].push(d[106]),d[101])}])}):c.resolve()},function(a){return d[100]=d[101]}])},function(a){return d[87].set(d[97],d[100])}])},function(a){return d[98]="videos",d[93]=d[79].get(d[98]),d[79],d[93]?d[94]=!1:d[94]=!0,d[94]?c.resolve():c.sequence([function(a){return d[93]?d[99]=!1:d[99]=!0,d[99]?c.resolve(d[100]=void 0):c.sequence([function(a){return d[101]=c.createArray(),d[102]=c.i64.of_int32(d[93].length),c.i64.gt(d[102],c.i64.cast([0,0]))?c.loopAsync(d[102],function(a){return d[103]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[93],d[103]).then(function(a){return a=a,d[104]=a[0],d[105]=a[1],a})},function(a){return d[106]=new c.Map(),d[108]="key_type",d[107]=d[104].get(d[108]),d[104],d[107]!==void 0?d[106].set(d[108],d[107]):0,d[109]=(d[101].push(d[106]),d[101])}])}):c.resolve()},function(a){return d[100]=d[101]}])},function(a){return d[87].set(d[98],d[100])}])},function(a){return d[86]=d[87]}])},function(a){return d[78].set(d[83],d[86])}])},function(a){return d[84]="metadata",d[81]=d[42].get(d[84]),d[42],d[81]?d[82]=!1:d[82]=!0,d[82]?c.resolve():c.sequence([function(a){return d[81]?d[85]=!1:d[85]=!0,d[85]?c.resolve(d[86]=void 0):c.sequence([function(a){return d[87]=d[81].get("__typename"),d[81],d[87]==="XMSGGroupsContentLoggingMetadata"?c.resolve((d[89]=new c.Map(),d[91]="num_members",d[90]=d[81].get(d[91]),d[81],c.i64.neq(d[90],void 0)?d[89].set(d[91],d[90]):0,d[88]=d[89])):c.sequence([function(a){return function(a){c.logger(a).warn(a)}(["Unknown subtype for LSXMSGContentLoggingMetadataUnion: ","",d[87]].join("")),d[89]=new c.Map(),d[90]=d[81].keys(),d[91]=c.i64.of_int32(d[90].length),c.i64.gt(d[91],c.i64.cast([0,0]))?c.loopAsync(d[91],function(a){return d[92]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[90],d[92]).then(function(a){return a=a,d[93]=a[0],d[94]=a[1],a})},function(a){return d[95]=d[81].get(d[93]),d[81],d[89].set(d[93],d[95])}])}):c.resolve()},function(a){return d[88]=d[89]}])},function(a){return d[88].set("__typename",d[87]),d[86]=d[88]}])},function(a){return d[78].set(d[84],d[86])}])},function(a){return d[77]=d[78]}])},function(a){return d[9].set(d[70],d[77])}])},function(a){return d[71]="suggested_moderation_actions",d[44]=d[8].get(d[71]),d[8],d[44]?d[45]=!1:d[45]=!0,d[45]?c.resolve():c.sequence([function(a){return d[44]?d[76]=!1:d[76]=!0,d[76]?c.resolve(d[77]=void 0):c.sequence([function(a){return d[78]=new c.Map(),d[82]="suggested_moderation_actions_list",d[79]=d[44].get(d[82]),d[44],d[79]?d[80]=!1:d[80]=!0,d[80]?c.resolve():c.sequence([function(a){return d[79]?d[84]=!1:d[84]=!0,d[84]?c.resolve(d[85]=void 0):c.sequence([function(a){return d[86]=new c.Map(),d[89]="suggested_moderation_actions",d[87]=d[79].get(d[89]),d[79],d[87]?d[88]=!1:d[88]=!0,d[88]?c.resolve():c.sequence([function(a){return d[87]?d[90]=!1:d[90]=!0,d[90]?c.resolve(d[91]=void 0):c.sequence([function(a){return d[92]=c.createArray(),d[93]=c.i64.of_int32(d[87].length),c.i64.gt(d[93],c.i64.cast([0,0]))?c.loopAsync(d[93],function(a){return d[94]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[87],d[94]).then(function(a){return a=a,d[95]=a[0],d[96]=a[1],a})},function(a){return d[97]=new c.Map(),d[100]="primary_action",d[98]=d[95].get(d[100]),d[95],d[98]!==void 0?d[97].set(d[100],d[98]):0,d[101]="chained_actions",d[99]=d[95].get(d[101]),d[95],d[99]!==void 0?d[97].set(d[101],d[99]):0,d[102]=(d[92].push(d[97]),d[92])}])}):c.resolve()},function(a){return d[91]=d[92]}])},function(a){return d[86].set(d[89],d[91])}])},function(a){return d[85]=d[86]}])},function(a){return d[78].set(d[82],d[85])}])},function(a){return d[83]="suggested_moderation_actions_json",d[81]=d[44].get(d[83]),d[44],d[81]!==void 0?d[78].set(d[83],d[81]):0,d[77]=d[78]}])},function(a){return d[9].set(d[71],d[77])}])},function(a){return d[72]="highlights_tab_custom_card_metadata",d[46]=d[8].get(d[72]),d[8],d[46]?d[47]=!1:d[47]=!0,d[47]?0:(d[46]?d[76]=!1:d[76]=!0,d[76]?d[77]=void 0:(d[78]=new c.Map(),d[81]="is_custom_card",d[79]=d[46].get(d[81]),d[46],d[79]!==void 0?d[78].set(d[81],d[79]):0,d[82]="moment",d[80]=d[46].get(d[82]),d[46],d[80]!==void 0?d[78].set(d[82],d[80]):0,d[77]=d[78]),d[9].set(d[72],d[77])),d[73]="business_thread_response_feedback",d[48]=d[8].get(d[73]),d[8],d[48]?d[49]=!1:d[49]=!0,d[49]?0:(d[48]?d[76]=!1:d[76]=!0,d[76]?d[77]=void 0:(d[78]=new c.Map(),d[80]="is_feedback_button_enabled_for_message",d[79]=d[48].get(d[80]),d[48],d[79]!==void 0?d[78].set(d[80],d[79]):0,d[77]=d[78]),d[9].set(d[73],d[77])),d[74]="live_shopping_metadata",d[50]=d[8].get(d[74]),d[8],d[50]?d[51]=!1:d[51]=!0,d[51]?0:(d[50]?d[76]=!1:d[76]=!0,d[76]?d[77]=void 0:(d[78]=new c.Map(),d[80]="referral_post_id",d[79]=d[50].get(d[80]),d[50],d[79]!==void 0?d[78].set(d[80],d[79]):0,d[77]=d[78]),d[9].set(d[74],d[77])),d[75]="reply_metadata",d[52]=d[8].get(d[75]),d[8],d[52]?d[53]=!1:d[53]=!0,d[53]?0:(d[52]?d[76]=!1:d[76]=!0,d[76]?d[77]=void 0:(d[78]=new c.Map(),d[80]="is_markdown",d[79]=d[52].get(d[80]),d[52],d[79]!==void 0?d[78].set(d[80],d[79]):0,d[77]=d[78]),d[9].set(d[75],d[77])),d[6]=d[9]}]):c.resolve((d[8]=new c.Map(),d[6]=d[8]))},function(a){return d[1]=d[6]}]))})},function(e){return d[1]?d[3]=!1:d[3]=!0,d[3]?0:(d[6]=new c.Map(),d[6].set("ad_client_token",a[5]),d[6].set("ad_preference_url",a[6]),d[6].set("ad_help_url",a[7]),d[6].set("show_ad_choice_icon",a[8]),d[6].set("title",a[3]),d[6].set("action_url",a[9]),d[6].set("admin_message_nickname_participant_id",a[10]),d[6].set("target_id",a[11]),d[6].set("target_title",a[12]),d[6].set("identifier_name",void 0),d[1].set("admin_message",d[6])),d[1]?d[4]=!1:d[4]=!0,d[4]?c.resolve(d[5]=void 0):c.sequence([function(a){return d[6]=new c.Map(),d[52]="sticker",d[7]=d[1].get(d[52]),d[1],d[7]?d[8]=!1:d[8]=!0,d[8]?0:(d[7]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[83]="sticker_pack_id",d[79]=d[7].get(d[83]),d[7],d[79]!==void 0?d[78].set(d[83],d[79]):0,d[84]="sticker_id",d[80]=d[7].get(d[84]),d[7],d[80]!==void 0?d[78].set(d[84],d[80]):0,d[85]="avatar_style",d[81]=d[7].get(d[85]),d[7],d[81]!==void 0?d[78].set(d[85],d[81]):0,d[86]="avatar_revision_id",d[82]=d[7].get(d[86]),d[7],c.i64.neq(d[82],void 0)?(c.i64.neq(d[82],void 0)?d[87]=c.i64.to_string(d[82]):d[87]=void 0,d[78].set(d[86],d[87])):0,d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[52],d[75]):0),d[53]="word_effects",d[9]=d[1].get(d[53]),d[1],d[9]?d[10]=!1:d[10]=!0,d[10]?0:(d[9]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[85]="magic_word_offsets",d[79]=d[9].get(d[85]),d[9],d[79]?d[80]=!1:d[80]=!0,d[80]?0:d[78].set(d[85],d[79]),d[86]="magic_word_lengths",d[81]=d[9].get(d[86]),d[9],d[81]?d[82]=!1:d[82]=!0,d[82]?0:d[78].set(d[86],d[81]),d[87]="magic_word_emojis",d[83]=d[9].get(d[87]),d[9],d[83]?d[84]=!1:d[84]=!0,d[84]?0:(d[88]=c.i64.of_int32(d[83].length),c.i64.neq(d[88],c.i64.cast([0,0]))?d[78].set(d[87],d[83]):0),d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[53],d[75]):0),d[54]="ig_avatar_sticker",d[11]=d[1].get(d[54]),d[1],d[11]?d[12]=!1:d[12]=!0,d[12]?0:(d[11]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[80]="is_avatar_sticker",d[79]=d[11].get(d[80]),d[11],d[79]!==void 0?d[78].set(d[80],d[79]):0,d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[54],d[75]):0),d[55]="power_up",d[13]=d[1].get(d[55]),d[1],d[13]?d[14]=!1:d[14]=!0,d[14]?0:(d[13]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[80]="power_up_style",d[79]=d[13].get(d[80]),d[13],d[79]!==void 0?d[78].set(d[80],d[79]):0,d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[55],d[75]):0),d[56]="ai_bot",d[15]=d[1].get(d[56]),d[1],d[15]?d[16]=!1:d[16]=!0,d[16]?0:(d[15]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[97]="response_id",d[79]=d[15].get(d[97]),d[15],d[79]!==void 0?d[78].set(d[97],d[79]):0,d[98]="bot_action",d[80]=d[15].get(d[98]),d[15],d[80]!==void 0?d[78].set(d[98],d[80]):0,d[99]="sentiment",d[81]=d[15].get(d[99]),d[15],d[81]!==void 0?d[78].set(d[99],d[81]):0,d[100]="sentiment_intensity",d[82]=d[15].get(d[100]),d[15],d[82]!==void 0?d[78].set(d[100],d[82]):0,d[101]="bot_action_int",d[83]=d[15].get(d[101]),d[15],c.i64.neq(d[83],void 0)?d[78].set(d[101],d[83]):0,d[102]="sentiment_int",d[84]=d[15].get(d[102]),d[15],c.i64.neq(d[84],void 0)?d[78].set(d[102],d[84]):0,d[103]="sentiment_intensity_int",d[85]=d[15].get(d[103]),d[15],c.i64.neq(d[85],void 0)?d[78].set(d[103],d[85]):0,d[104]="bot_invocation_message_id",d[86]=d[15].get(d[104]),d[15],d[86]!==void 0?d[78].set(d[104],d[86]):0,d[105]="bot_response_id",d[87]=d[15].get(d[105]),d[15],d[87]!==void 0?d[78].set(d[105],d[87]):0,d[106]="bot_invocation_message_otid",d[88]=d[15].get(d[106]),d[15],d[88]!==void 0?d[78].set(d[106],d[88]):0,d[107]="bot_invocation_logging_id",d[89]=d[15].get(d[107]),d[15],d[89]!==void 0?d[78].set(d[107],d[89]):0,d[108]="is_error",d[90]=d[15].get(d[108]),d[15],d[90]!==void 0?d[78].set(d[108],d[90]):0,d[109]="bot_subscription_id",d[91]=d[15].get(d[109]),d[15],c.i64.neq(d[91],void 0)?(c.i64.neq(d[91],void 0)?d[114]=c.i64.to_string(d[91]):d[114]=void 0,d[78].set(d[109],d[114])):0,d[110]="bot_subscription_product_type",d[92]=d[15].get(d[110]),d[15],d[92]!==void 0?d[78].set(d[110],d[92]):0,d[111]="bot_response_product_type",d[93]=d[15].get(d[111]),d[15],d[93]!==void 0?d[78].set(d[111],d[93]):0,d[112]="original_prompt_text",d[94]=d[15].get(d[112]),d[15],d[94]!==void 0?d[78].set(d[112],d[94]):0,d[113]="bot_response_additional_message_otids",d[95]=d[15].get(d[113]),d[15],d[95]?d[96]=!1:d[96]=!0,d[96]?0:(d[114]=c.i64.of_int32(d[95].length),c.i64.neq(d[114],c.i64.cast([0,0]))?d[78].set(d[113],d[95]):0),d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[56],d[75]):0),d[57]="pobox",d[17]=d[1].get(d[57]),d[1],d[17]?d[18]=!1:d[18]=!0,d[18]?0:(d[17]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[81]="pobox_fbid",d[79]=d[17].get(d[81]),d[17],c.i64.neq(d[79],void 0)?(c.i64.neq(d[79],void 0)?d[83]=c.i64.to_string(d[79]):d[83]=void 0,d[78].set(d[81],d[83])):0,d[82]="pobox_id",d[80]=d[17].get(d[82]),d[17],d[80]!==void 0?d[78].set(d[82],d[80]):0,d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[57],d[75]):0),d[58]="video",d[19]=d[1].get(d[58]),d[1],d[19]?d[20]=!1:d[20]=!0,d[20]?0:(d[19]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[80]="unified_upload_mos",d[79]=d[19].get(d[80]),d[19],d[79]!==void 0?d[78].set(d[80],d[79]):0,d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[58],d[75]):0),d[59]="text_translation",d[21]=d[1].get(d[59]),d[1],d[21]?d[22]=!1:d[22]=!0,d[22]?0:(d[21]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[82]="translated_text",d[79]=d[21].get(d[82]),d[21],d[79]!==void 0?d[78].set(d[82],d[79]):0,d[83]="text_dialect",d[80]=d[21].get(d[83]),d[21],d[80]!==void 0?d[78].set(d[83],d[80]):0,d[84]="translated_text_dialect",d[81]=d[21].get(d[84]),d[21],d[81]!==void 0?d[78].set(d[84],d[81]):0,d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[59],d[75]):0),d[60]="memories",d[23]=d[1].get(d[60]),d[1],d[23]?d[24]=!1:d[24]=!0,d[24]?0:(d[23]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[82]="original_message_id",d[79]=d[23].get(d[82]),d[23],d[79]!==void 0?d[78].set(d[82],d[79]):0,d[83]="original_message_creation_ts",d[80]=d[23].get(d[83]),d[23],c.i64.neq(d[80],void 0)?(c.i64.neq(d[80],void 0)?d[85]=c.i64.to_string(d[80]):d[85]=void 0,d[78].set(d[83],d[85])):0,d[84]="memory_server_id",d[81]=d[23].get(d[84]),d[23],c.i64.neq(d[81],void 0)?(c.i64.neq(d[81],void 0)?d[85]=c.i64.to_string(d[81]):d[85]=void 0,d[78].set(d[84],d[85])):0,d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[60],d[75]):0),d[61]="command",d[25]=d[1].get(d[61]),d[1],d[25]?d[26]=!1:d[26]=!0,d[26]?0:(d[25]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[80]="command_type",d[79]=d[25].get(d[80]),d[25],c.i64.neq(d[79],void 0)?d[78].set(d[80],d[79]):0,d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[61],d[75]):0),d[62]="admin_message",d[27]=d[1].get(d[62]),d[1],d[27]?d[28]=!1:d[28]=!0,d[28]?0:(d[27]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[89]="ad_client_token",d[79]=d[27].get(d[89]),d[27],d[79]!==void 0?d[78].set(d[89],d[79]):0,d[90]="ad_preference_url",d[80]=d[27].get(d[90]),d[27],d[80]!==void 0?d[78].set(d[90],d[80]):0,d[91]="ad_help_url",d[81]=d[27].get(d[91]),d[27],d[81]!==void 0?d[78].set(d[91],d[81]):0,d[92]="show_ad_choice_icon",d[82]=d[27].get(d[92]),d[27],d[82]!==void 0?d[78].set(d[92],d[82]):0,d[93]="title",d[83]=d[27].get(d[93]),d[27],d[83]!==void 0?d[78].set(d[93],d[83]):0,d[94]="action_url",d[84]=d[27].get(d[94]),d[27],d[84]!==void 0?d[78].set(d[94],d[84]):0,d[95]="admin_message_nickname_participant_id",d[85]=d[27].get(d[95]),d[27],c.i64.neq(d[85],void 0)?(c.i64.neq(d[85],void 0)?d[99]=c.i64.to_string(d[85]):d[99]=void 0,d[78].set(d[95],d[99])):0,d[96]="target_id",d[86]=d[27].get(d[96]),d[27],c.i64.neq(d[86],void 0)?(c.i64.neq(d[86],void 0)?d[99]=c.i64.to_string(d[86]):d[99]=void 0,d[78].set(d[96],d[99])):0,d[97]="target_title",d[87]=d[27].get(d[97]),d[27],d[87]!==void 0?d[78].set(d[97],d[87]):0,d[98]="identifier_name",d[88]=d[27].get(d[98]),d[27],d[88]!==void 0?d[78].set(d[98],d[88]):0,d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[62],d[75]):0),d[63]="misinfo_metadata",d[29]=d[1].get(d[63]),d[1],d[29]?d[30]=!1:d[30]=!0,d[30]?0:(d[29]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[81]="has_misinfo",d[79]=d[29].get(d[81]),d[29],d[79]!==void 0?d[78].set(d[81],d[79]):0,d[82]="misinfo_source",d[80]=d[29].get(d[82]),d[29],d[80]!==void 0?d[78].set(d[82],d[80]):0,d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[63],d[75]):0),d[64]="forwarded_message",d[31]=d[1].get(d[64]),d[1],d[31]?d[32]=!1:d[32]=!0,d[32]?0:(d[31]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[81]="forwarded_from_thread_name",d[79]=d[31].get(d[81]),d[31],d[79]!==void 0?d[78].set(d[81],d[79]):0,d[82]="forwarded_from_thread_url",d[80]=d[31].get(d[82]),d[31],d[80]!==void 0?d[78].set(d[82],d[80]):0,d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[64],d[75]):0),d[65]="ai_metadata",d[33]=d[1].get(d[65]),d[1],d[33]?d[34]=!1:d[34]=!0,d[34]?0:(d[33]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[83]="is_ai_generated",d[79]=d[33].get(d[83]),d[33],d[79]!==void 0?d[78].set(d[83],d[79]):0,d[84]="gen_ai_integrity_ent_id",d[80]=d[33].get(d[84]),d[33],c.i64.neq(d[80],void 0)?(c.i64.neq(d[80],void 0)?d[87]=c.i64.to_string(d[80]):d[87]=void 0,d[78].set(d[84],d[87])):0,d[85]="ai_product",d[81]=d[33].get(d[85]),d[33],d[81]!==void 0?d[78].set(d[85],d[81]):0,d[86]="original_prompt_text",d[82]=d[33].get(d[86]),d[33],d[82]!==void 0?d[78].set(d[86],d[82]):0,d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[65],d[75]):0),d[66]="encrypted_message",d[35]=d[1].get(d[66]),d[1],d[35]?d[36]=!1:d[36]=!0,d[36]?c.resolve():c.sequence([function(a){return d[35]?d[74]=!1:d[74]=!0,d[74]?c.resolve(d[75]=void 0):c.sequence([function(a){return d[78]=new c.Map(),d[86]="thread_id",d[79]=d[35].get(d[86]),d[35],d[79]!==void 0?d[78].set(d[86],d[79]):0,d[87]="offline_threading_id",d[80]=d[35].get(d[87]),d[35],d[80]!==void 0?d[78].set(d[87],d[80]):0,d[88]="toplevel_payload",d[81]=d[35].get(d[88]),d[35],d[81]?d[82]=!1:d[82]=!0,d[82]?0:(d[91]=new c.Map(),d[97]="encrypted_payload",d[92]=d[81].get(d[97]),d[81],d[92]!==void 0?d[91].set(d[97],d[92]):0,d[98]="payloadTimestampMs",d[93]=d[81].get(d[98]),d[81],c.i64.neq(d[93],void 0)?d[91].set(d[98],c.i64.to_string(d[93])):0,d[99]="encryption_version",d[94]=d[81].get(d[99]),d[81],c.i64.neq(d[94],void 0)?d[91].set(d[99],d[94]):0,d[100]="epoch_id",d[95]=d[81].get(d[100]),d[81],c.i64.neq(d[95],void 0)?d[91].set(d[100],c.i64.to_string(d[95])):0,d[101]="epoch_anon_id",d[96]=d[81].get(d[101]),d[81],d[96]!==void 0?d[91].set(d[101],d[96]):0,d[78].set(d[88],d[91])),d[89]="supplemental_payloads",d[83]=d[35].get(d[89]),d[35],d[83]?d[84]=!1:d[84]=!0,d[84]?c.resolve():c.sequence([function(a){return d[91]=c.createArray(),d[92]=c.i64.of_int32(d[83].length),c.i64.gt(d[92],c.i64.cast([0,0]))?c.loopAsync(d[92],function(a){return d[93]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[83],d[93]).then(function(a){return a=a,d[94]=a[0],d[95]=a[1],a})},function(a){return d[96]=new c.Map(),d[101]="encrypted_supplemental_key",d[97]=d[94].get(d[101]),d[94],d[97]!==void 0?d[96].set(d[101],d[97]):0,d[102]="supplemental_key_ciphertext",d[98]=d[94].get(d[102]),d[94],d[98]!==void 0?d[96].set(d[102],d[98]):0,d[103]="encrypted_supplemental_payload",d[99]=d[94].get(d[103]),d[94],d[99]?d[100]=!1:d[100]=!0,d[100]?0:(d[104]=new c.Map(),d[110]="encrypted_payload",d[105]=d[99].get(d[110]),d[99],d[105]!==void 0?d[104].set(d[110],d[105]):0,d[111]="payloadTimestampMs",d[106]=d[99].get(d[111]),d[99],c.i64.neq(d[106],void 0)?d[104].set(d[111],c.i64.to_string(d[106])):0,d[112]="encryption_version",d[107]=d[99].get(d[112]),d[99],c.i64.neq(d[107],void 0)?d[104].set(d[112],d[107]):0,d[113]="epoch_id",d[108]=d[99].get(d[113]),d[99],c.i64.neq(d[108],void 0)?d[104].set(d[113],c.i64.to_string(d[108])):0,d[114]="epoch_anon_id",d[109]=d[99].get(d[114]),d[99],d[109]!==void 0?d[104].set(d[114],d[109]):0,d[96].set(d[103],d[104])),d[104]=(d[91].push(d[96]),d[91])}])}):c.resolve()},function(a){return d[78].set(d[89],d[91])}])},function(a){return d[90]="is_open_eb",d[85]=d[35].get(d[90]),d[35],d[85]!==void 0?d[78].set(d[90],d[85]):0,d[75]=d[78]}])},function(a){return d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[66],d[75]):0}])},function(a){return d[67]="rich_text",d[37]=d[1].get(d[67]),d[1],d[37]?d[38]=!1:d[38]=!0,d[38]?0:(d[37]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[80]="rich_text_format_type",d[79]=d[37].get(d[80]),d[37],c.i64.neq(d[79],void 0)?d[78].set(d[80],d[79]):0,d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[67],d[75]):0),d[68]="content_logging_metadata",d[39]=d[1].get(d[68]),d[1],d[39]?d[40]=!1:d[40]=!0,d[40]?c.resolve():c.sequence([function(a){return d[39]?d[74]=!1:d[74]=!0,d[74]?c.resolve(d[75]=void 0):c.sequence([function(a){return d[78]=new c.Map(),d[83]="containing_post",d[79]=d[39].get(d[83]),d[39],d[79]?d[80]=!1:d[80]=!0,d[80]?c.resolve():c.sequence([function(a){return d[79]?d[85]=!1:d[85]=!0,d[85]?c.resolve(d[86]=void 0):c.sequence([function(a){return d[89]=new c.Map(),d[97]="key_type",d[90]=d[79].get(d[97]),d[79],d[90]!==void 0?d[89].set(d[97],d[90]):0,d[98]="fb_post_type",d[91]=d[79].get(d[98]),d[79],d[91]?d[92]=!1:d[92]=!0,d[92]?0:(d[101]=c.i64.of_int32(d[91].length),c.i64.neq(d[101],c.i64.cast([0,0]))?d[89].set(d[98],d[91]):0),d[99]="photos",d[93]=d[79].get(d[99]),d[79],d[93]?d[94]=!1:d[94]=!0,d[94]?c.resolve():c.sequence([function(a){return d[93]?d[101]=!1:d[101]=!0,d[101]?c.resolve(d[102]=void 0):c.sequence([function(a){return d[104]=c.createArray(),d[105]=c.i64.of_int32(d[93].length),c.i64.gt(d[105],c.i64.cast([0,0]))?c.loopAsync(d[105],function(a){return d[106]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[93],d[106]).then(function(a){return a=a,d[107]=a[0],d[108]=a[1],a})},function(a){return d[109]=new c.Map(),d[111]="key_type",d[110]=d[107].get(d[111]),d[107],d[110]!==void 0?d[109].set(d[111],d[110]):0,d[112]=(d[104].push(d[109]),d[104])}])}):c.resolve()},function(a){return d[102]=d[104]}])},function(a){return d[103]=c.i64.of_int32(d[102].length),c.i64.neq(d[103],c.i64.cast([0,0]))?d[89].set(d[99],d[102]):0}])},function(a){return d[100]="videos",d[95]=d[79].get(d[100]),d[79],d[95]?d[96]=!1:d[96]=!0,d[96]?c.resolve():c.sequence([function(a){return d[95]?d[101]=!1:d[101]=!0,d[101]?c.resolve(d[102]=void 0):c.sequence([function(a){return d[104]=c.createArray(),d[105]=c.i64.of_int32(d[95].length),c.i64.gt(d[105],c.i64.cast([0,0]))?c.loopAsync(d[105],function(a){return d[106]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[95],d[106]).then(function(a){return a=a,d[107]=a[0],d[108]=a[1],a})},function(a){return d[109]=new c.Map(),d[111]="key_type",d[110]=d[107].get(d[111]),d[107],d[110]!==void 0?d[109].set(d[111],d[110]):0,d[112]=(d[104].push(d[109]),d[104])}])}):c.resolve()},function(a){return d[102]=d[104]}])},function(a){return d[103]=c.i64.of_int32(d[102].length),c.i64.neq(d[103],c.i64.cast([0,0]))?d[89].set(d[100],d[102]):0}])},function(a){return d[86]=d[89]}])},function(a){return d[87]=d[86].keys(),d[88]=c.i64.of_int32(d[87].length),c.i64.neq(d[88],c.i64.cast([0,0]))?d[78].set(d[83],d[86]):0}])},function(a){return d[84]="metadata",d[81]=d[39].get(d[84]),d[39],d[81]?d[82]=!1:d[82]=!0,d[82]?0:(d[81]?d[85]=!1:d[85]=!0,d[85]?d[86]=void 0:(d[89]=d[81].get("__typename"),d[81],d[89]==="XMSGGroupsContentLoggingMetadata"?(d[91]=new c.Map(),d[93]="num_members",d[92]=d[81].get(d[93]),d[81],c.i64.neq(d[92],void 0)?d[91].set(d[93],d[92]):0,d[90]=d[91]):(function(a){c.logger(a).warn(a)}(["Unknown subtype for LSXMSGContentLoggingMetadataUnion: ","",d[89]].join("")),d[90]=d[81]),d[90].set("__typename",d[89]),d[86]=d[90]),d[87]=d[86].keys(),d[88]=c.i64.of_int32(d[87].length),c.i64.neq(d[88],c.i64.cast([0,0]))?d[78].set(d[84],d[86]):0),d[75]=d[78]}])},function(a){return d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[68],d[75]):0}])},function(a){return d[69]="suggested_moderation_actions",d[41]=d[1].get(d[69]),d[1],d[41]?d[42]=!1:d[42]=!0,d[42]?c.resolve():c.sequence([function(a){return d[41]?d[74]=!1:d[74]=!0,d[74]?c.resolve(d[75]=void 0):c.sequence([function(a){return d[78]=new c.Map(),d[82]="suggested_moderation_actions_list",d[79]=d[41].get(d[82]),d[41],d[79]?d[80]=!1:d[80]=!0,d[80]?c.resolve():c.sequence([function(a){return d[79]?d[84]=!1:d[84]=!0,d[84]?c.resolve(d[85]=void 0):c.sequence([function(a){return d[88]=new c.Map(),d[91]="suggested_moderation_actions",d[89]=d[79].get(d[91]),d[79],d[89]?d[90]=!1:d[90]=!0,d[90]?c.resolve():c.sequence([function(a){return d[89]?d[92]=!1:d[92]=!0,d[92]?c.resolve(d[93]=void 0):c.sequence([function(a){return d[95]=c.createArray(),d[96]=c.i64.of_int32(d[89].length),c.i64.gt(d[96],c.i64.cast([0,0]))?c.loopAsync(d[96],function(a){return d[97]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[89],d[97]).then(function(a){return a=a,d[98]=a[0],d[99]=a[1],a})},function(a){return d[100]=new c.Map(),d[103]="primary_action",d[101]=d[98].get(d[103]),d[98],d[101]!==void 0?d[100].set(d[103],d[101]):0,d[104]="chained_actions",d[102]=d[98].get(d[104]),d[98],d[102]!==void 0?d[100].set(d[104],d[102]):0,d[105]=(d[95].push(d[100]),d[95])}])}):c.resolve()},function(a){return d[93]=d[95]}])},function(a){return d[94]=c.i64.of_int32(d[93].length),c.i64.neq(d[94],c.i64.cast([0,0]))?d[88].set(d[91],d[93]):0}])},function(a){return d[85]=d[88]}])},function(a){return d[86]=d[85].keys(),d[87]=c.i64.of_int32(d[86].length),c.i64.neq(d[87],c.i64.cast([0,0]))?d[78].set(d[82],d[85]):0}])},function(a){return d[83]="suggested_moderation_actions_json",d[81]=d[41].get(d[83]),d[41],d[81]!==void 0?d[78].set(d[83],d[81]):0,d[75]=d[78]}])},function(a){return d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[69],d[75]):0}])},function(a){return d[70]="highlights_tab_custom_card_metadata",d[43]=d[1].get(d[70]),d[1],d[43]?d[44]=!1:d[44]=!0,d[44]?0:(d[43]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[81]="is_custom_card",d[79]=d[43].get(d[81]),d[43],d[79]!==void 0?d[78].set(d[81],d[79]):0,d[82]="moment",d[80]=d[43].get(d[82]),d[43],d[80]!==void 0?d[78].set(d[82],d[80]):0,d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[70],d[75]):0),d[71]="business_thread_response_feedback",d[45]=d[1].get(d[71]),d[1],d[45]?d[46]=!1:d[46]=!0,d[46]?0:(d[45]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[80]="is_feedback_button_enabled_for_message",d[79]=d[45].get(d[80]),d[45],d[79]!==void 0?d[78].set(d[80],d[79]):0,d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[71],d[75]):0),d[72]="live_shopping_metadata",d[47]=d[1].get(d[72]),d[1],d[47]?d[48]=!1:d[48]=!0,d[48]?0:(d[47]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[80]="referral_post_id",d[79]=d[47].get(d[80]),d[47],d[79]!==void 0?d[78].set(d[80],d[79]):0,d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[72],d[75]):0),d[73]="reply_metadata",d[49]=d[1].get(d[73]),d[1],d[49]?d[50]=!1:d[50]=!0,d[50]?0:(d[49]?d[74]=!1:d[74]=!0,d[74]?d[75]=void 0:(d[78]=new c.Map(),d[80]="is_markdown",d[79]=d[49].get(d[80]),d[49],d[79]!==void 0?d[78].set(d[80],d[79]):0,d[75]=d[78]),d[76]=d[75].keys(),d[77]=c.i64.of_int32(d[76].length),c.i64.neq(d[77],c.i64.cast([0,0]))?d[6].set(d[73],d[75]):0),d[51]=c.toJSON(d[6]),d[5]=d[51]}])},function(b){return c.forEach(c.filter(c.db.table(12).fetch([[[a[0],a[1],a[2]]]]),function(b){return c.i64.eq(b.threadKey,a[0])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&c.i64.eq(b.timestampMs,a[1])&&b.messageId===a[2]}),function(b){var c=b.update;b.item;return c({adminMsgCtaId:d[0],adminMsgCtaTitle:a[3],adminMsgCtaType:a[4],metadataDataclass:d[5]})})}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxApplyAdminMessageCTAStoredProcedure";e.exports=a}),null);/*FB_PKG_DELIM*/
__d("LSAddParticipantIdToGroupThread",["LSComputeParticipantCapabilities"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return c.storedProcedure(b("LSComputeParticipantCapabilities"),a[1],a[0]).then(function(a){return a=a,d[0]=a[0],a})},function(b){return c.filter(c.db.table(14).fetch([[[a[0],a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[0])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&c.i64.eq(b.contactId,a[1])&&c.i64.gt(b.authorityLevel,a[9])}).next().then(function(b){var e=b.done;b.value;return e?c.db.table(14).put({threadKey:a[0],contactId:a[1],readWatermarkTimestampMs:a[2],readActionTimestampMs:a[3],deliveredWatermarkTimestampMs:a[4],nickname:a[5],normalizedSearchTerms:a[10],isAdmin:a[6],isSuperAdmin:a[13],subscribeSource:a[7],authorityLevel:a[9],participantCapabilities:d[0],groupParticipantJoinState:a[11],isModerator:a[12],threadRoles:a[14]}):0})}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxAddParticipantIdToGroupThreadStoredProcedure";e.exports=a}),null);
__d("LSClearPinnedMessages",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.db.table(205).fetch([[[a[0]]]]),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxClearPinnedMessagesStoredProcedure";e.exports=a}),null);
__d("LSDeleteExistingMessageRanges",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.db.table(13).fetch([[[a[0]]]]),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxDeleteExistingMessageRangesStoredProcedure";e.exports=a}),null);
__d("LSForceWebClientRefresh.nop",["ClientConsistencyEventEmitter","CurrentUser","ODS","WebStorage","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=!1;function a(){var a=(i||(i=c("WebStorage"))).getSessionStorage();a&&!j&&(a.getItem("ls_forced_refresh")==="1"?(h||(h=d("ODS"))).bumpEntityKey(3303,"lightspeed_web.refresh_loop_detected",k(c("CurrentUser").getAppID())):a.setItem("ls_forced_refresh","1"));j=!0;switch(c("CurrentUser").getAppID()){case 772021112871879..toString():c("ClientConsistencyEventEmitter").emit("hardRefresh","ls_forced_refresh");break;default:c("ClientConsistencyEventEmitter").emit("softRefresh","ls_forced_refresh")}throw c("unrecoverableViolation")("Client must refresh to continue syncScript execution","messenger_web_product")}function k(a){switch(a){case String(772021112871879):return"messenger";case String(2220391788200892):return"facebook";case String(1217981644879628):case String(936619743392459):case String(487152425211411):case String(1035956773910536):return"instagram";default:return"unknown_app"}}g["default"]=a}),98);
__d("LSIssueExpireNewFriendBumpTask",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(b){return d[0]=new c.Map(),d[0].set("thread_key",a[0]),d[1]=c.toJSON(d[0]),d[3]=["expire_new_friend_bump",c.i64.to_string(a[0])].join(""),c.count(c.db.table(2).fetch([[[d[3]]],"queueNameTaskId"])).then(function(a){return d[2]=a})},function(e){return c.i64.eq(d[2],c.i64.cast([0,0]))?c.storedProcedure(b("LSIssueNewTask"),d[3],c.i64.cast([0,416]),d[1],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,100]),void 0,void 0,a[1],c.i64.cast([0,0])):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxIssueExpireNewFriendBumpTaskStoredProcedure";e.exports=a}),null);
__d("LSIssueThreadCapabilitySyncTask",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.resolve(c)}a.__sproc_name__="LSMailboxIssueThreadCapabilitySyncTaskStoredProcedure";e.exports=a}),null);
__d("LSSetForwardScore",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.filter(b.db.table(12).fetch([[[a[0],a[2],a[1]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(c.timestampMs,a[2])&&c.messageId===a[1]}),function(b){var c=b.update;b.item;return c({forwardScore:a[3]})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxSetForwardScoreStoredProcedure";e.exports=a}),null);
__d("LSSetHMPSStatus",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.resolve(c)}a.__sproc_name__="LSMailboxSetHMPSStatusStoredProcedure";e.exports=a}),null);
__d("LSTruncateMetadataThreads.nop",["Promise"],(function(a,b,c,d,e,f){"use strict";var g;a=function(a,c){return(g||(g=b("Promise"))).resolve()};f["default"]=a}),66);
__d("LSTruncateMetadataThreads",["LSTruncateMetadataThreads.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[];return c.sequence([function(a){return c.nativeOperation(b("LSTruncateMetadataThreads.nop"))},function(a){return c.resolve(d)}])}a.__sproc_name__="LSE2EEMessagingMetadataMailboxTruncateMetadataThreadsStoredProcedure";e.exports=a}),null);
__d("LSTruncateThreadRangeTablesForSyncGroup",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.sequence([function(c){return b.i64.eq(a[0],b.i64.cast([0,1]))?b.forEach(b.filter(b.db.table(10).fetch(),function(a){return b.i64.eq(b.i64.cast([0,1])==null?b.i64.cast([0,1]):b.i64.cast([0,1]),b.i64.cast([0,1]))}),function(a){return a["delete"]()}):b.i64.eq(a[0],b.i64.cast([0,95]))?b.forEach(b.filter(b.db.table(10).fetch([[[b.i64.cast([0,0])],[b.i64.cast([-1,4294967295])]]]),function(a){return b.i64.eq(b.i64.cast([0,1])==null?b.i64.cast([0,1]):b.i64.cast([0,1]),b.i64.cast([0,1]))&&(b.i64.eq(a.parentThreadKey,b.i64.cast([0,0]))||b.i64.eq(a.parentThreadKey,b.i64.cast([-1,4294967295])))}),function(a){return a["delete"]()}):b.resolve(0)},function(c){return b.i64.eq(a[0],b.i64.cast([0,1]))?b.forEach(b.filter(b.db.table(247).fetch(),function(a){return b.i64.eq(b.i64.cast([0,1])==null?b.i64.cast([0,1]):b.i64.cast([0,1]),b.i64.cast([0,1]))}),function(a){return a["delete"]()}):b.resolve()},function(c){return b.forEach(b.db.table(198).fetch([[[a[0]]]]),function(a){return a["delete"]()})},function(c){return b.forEach(b.db.table(220).fetch([[[a[0]]]]),function(a){return a["delete"]()})}])},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxTruncateThreadRangeTablesForSyncGroupStoredProcedure";e.exports=a}),null);
__d("LSTruncateTablesForSyncGroup",["LSTruncateThreadRangeTablesForSyncGroup"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[];return c.sequence([function(d){return c.sequence([function(b){return c.forEach(c.filter(c.db.table(9).fetch(),function(b){return(c.i64.eq(b.syncGroup,a[0])||c.i64.eq(b.syncGroup,void 0)&&c.i64.eq(c.i64.cast([0,1]),a[0]))&&![c.i64.cast([0,17]),c.i64.cast([0,18]),c.i64.cast([0,19]),c.i64.cast([0,20]),c.i64.cast([0,21]),c.i64.cast([0,22]),c.i64.cast([0,23]),c.i64.cast([0,24]),c.i64.cast([0,25]),c.i64.cast([0,26])].some(function(a){return c.i64.eq(b.threadType,a)})}),function(a){return a["delete"]()})},function(d){return c.storedProcedure(b("LSTruncateThreadRangeTablesForSyncGroup"),a[0])}])},function(a){return c.resolve(d)}])}a.__sproc_name__="LSMailboxTruncateTablesForSyncGroupStoredProcedure";e.exports=a}),null);
__d("LSUpdateReadReceipt",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.filter(b.db.table(14).fetch([[[a[1],a[2]]]]),function(c){return b.i64.eq(c.threadKey,a[1])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(c.contactId,a[2])&&b.i64.lt(c.readWatermarkTimestampMs,a[0])}),function(c){var d=c.update;c=c.item;return d({readWatermarkTimestampMs:a[0],readActionTimestampMs:b.i64.gt(a[3],b.i64.cast([0,0]))?a[3]:c.readActionTimestampMs})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxUpdateReadReceiptStoredProcedure";e.exports=a}),null);
__d("LSUpdateThreadsRangesV2",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.sequence([function(c){return b.forEach(b.db.table(10).fetch([[[a[1]]]]),function(a){return a["delete"]()})},function(d){return c[8]=b.i64.gt(a[2],b.i64.cast([0,1]))&&b.i64.gt(a[3],b.i64.cast([-2147483648,0])),a[0]==="inbox"&&b.i64.eq(a[1],b.i64.cast([0,0]))&&b.i64.eq(a[4],b.i64.cast([0,1]))?b.sequence([function(d){return c[9]=a[2],c[10]=a[3],c[11]=!1,c[12]=c[8],b.forEach(b.db.table(198).fetch(),function(a){a=a.item;return c[13]=a.minLastActivityTimestampMs,c[15]=a.minThreadKey,c[14]=b.i64.lt(c[9]==null?c[13]:c[9],c[13]),c[9]=c[14]?c[13]:c[9],c[10]=c[14]?c[15]:c[10],c[11]=c[11]||a.isLoadingBefore,c[12]=c[12]||b.i64.gt(c[13],b.i64.cast([0,1]))&&b.i64.gt(c[15],b.i64.cast([-2147483648,0]))})},function(a){return a=[c[9],c[10],c[11],c[12]],c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],a}]):b.resolve((d=[a[2],a[3],!1,c[8]],c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],d))},function(d){return b.i64.eq(a[4],b.i64.cast([0,1]))?b.sequence([function(d){return c[9]=c[0],c[10]=c[1],c[11]=c[2],c[12]=c[3],b.forEach(b.filter(b.db.table(220).fetch(),function(c){return b.i64.eq(c.parentThreadKey,a[1])}),function(a){a=a.item;return c[13]=a.minLastActivityTimestampMs,c[15]=a.minThreadKey,c[14]=b.i64.lt(c[9]==null?c[13]:c[9],c[13]),c[9]=c[14]?c[13]:c[9],c[10]=c[14]?c[15]:c[10],c[11]=c[11]||a.isLoadingBefore,c[12]=c[12]||b.i64.gt(c[13],b.i64.cast([0,1]))&&b.i64.gt(c[15],b.i64.cast([-2147483648,0]))})},function(a){return a=[c[9],c[10],c[11],c[12]],c[4]=a[0],c[5]=a[1],c[6]=a[2],c[7]=a[3],a}]):b.resolve((d=[c[0],c[1],c[2],c[3]],c[4]=d[0],c[5]=d[1],c[6]=d[2],c[7]=d[3],d))},function(d){return b.db.table(10).add({parentThreadKey:a[1],minThreadKey:c[5]==null?b.i64.cast([-2147483648,0]):c[5],minLastActivityTimestampMs:c[4]==null?b.i64.cast([0,1]):c[4],maxLastActivityTimestampMs:b.i64.cast([0,1]),maxThreadKey:b.i64.cast([-2147483648,0]),isLoadingBefore:c[6],isLoadingAfter:!1,hasMoreBefore:c[7],hasMoreAfter:!1})}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxUpdateThreadsRangesV2StoredProcedure";e.exports=a}),null);
__d("LSUpsertFolderSeenTimestamp",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.i64.gt(a[1],b.i64.cast([0,0]))?b.db.table(35).fetch([[[a[0]]]]).next().then(function(c,d){var e=c.done;c=c.value;return e?b.db.table(35).add({parentThreadKey:a[0],lastSeenRequestTimestampMs:a[1]}):(d=c.item,b.i64.lt(d.lastSeenRequestTimestampMs,a[1])?b.forEach(b.db.table(35).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({lastSeenRequestTimestampMs:a[1]})}):b.resolve())}):b.resolve()},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxUpsertFolderSeenTimestampStoredProcedure";e.exports=a}),null);
__d("LSUpsertMessage",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.db.table(12).fetch([[[a[9]]],"optimistic"]).next().then(function(c,d){var e=c.done;c=c.value;return e?b.db.table(12).add({threadKey:a[3],timestampMs:a[5],messageId:a[8],offlineThreadingId:a[9],authorityLevel:a[2],primarySortKey:a[6],senderId:a[10],isAdminMessage:a[12],sendStatus:a[15],sendStatusV2:a[16],text:a[0],subscriptErrorMessage:a[1],secondarySortKey:a[7],stickerId:a[11],messageRenderingType:a[13],isUnsent:a[17],unsentTimestampMs:a[18],mentionOffsets:a[19],mentionLengths:a[20],mentionIds:a[21],mentionTypes:a[22],replySourceId:a[23],replySourceType:a[24],replySourceTypeV2:a[25],replyStatus:a[26],replySnippet:a[27],replyMessageText:a[28],replyToUserId:a[29],replyMediaExpirationTimestampMs:a[30],replyMediaUrl:a[31],replyMediaPreviewWidth:a[33],replyMediaPreviewHeight:a[34],replyMediaUrlMimeType:a[35],replyMediaUrlFallback:a[36],replyCtaId:a[37],replyCtaTitle:a[38],replyAttachmentType:a[39],replyAttachmentId:a[40],replyAttachmentExtra:a[41],replyType:a[42],isForwarded:a[43],forwardScore:a[44],hasQuickReplies:a[45],adminMsgCtaId:a[46],adminMsgCtaTitle:a[47],adminMsgCtaType:a[48],cannotUnsendReason:a[49],textHasLinks:a[50],viewFlags:a[51],displayedContentTypes:a[52],viewedPluginKey:a[53],viewedPluginContext:a[54],quickReplyType:a[55],hotEmojiSize:a[56],platformXmdEncoded:a[57],replySourceTimestampMs:a[58],ephemeralDurationInSec:a[59],msUntilExpirationTs:a[60],ephemeralExpirationTs:a[61],takedownState:a[62],isCollapsed:a[63],subthreadKey:a[64],botResponseId:a[65],metadataDataclass:a[66],editCount:a[67],isPaidPartnership:a[68],adminSignatureName:a[69],adminSignatureProfileUrl:a[70],adminSignatureCreatorType:a[71]}):(d=c.item,b.i64.le(d.authorityLevel,a[2])?b.db.table(12).put({threadKey:a[3],timestampMs:a[5],messageId:a[8],offlineThreadingId:a[9],authorityLevel:a[2],primarySortKey:d.primarySortKey,senderId:a[10],isAdminMessage:a[12],sendStatus:a[15],sendStatusV2:a[16],text:a[0],subscriptErrorMessage:a[1],secondarySortKey:d.secondarySortKey,stickerId:a[11],messageRenderingType:a[13],isUnsent:a[17],unsentTimestampMs:a[18],mentionOffsets:a[19],mentionLengths:a[20],mentionIds:a[21],mentionTypes:a[22],replySourceId:a[23],replySourceType:a[24],replySourceTypeV2:a[25],replyStatus:a[26],replySnippet:a[27],replyMessageText:a[28],replyToUserId:a[29],replyMediaExpirationTimestampMs:a[30],replyMediaUrl:a[31],replyMediaPreviewWidth:a[33],replyMediaPreviewHeight:a[34],replyMediaUrlMimeType:a[35],replyMediaUrlFallback:a[36],replyCtaId:a[37],replyCtaTitle:a[38],replyAttachmentType:a[39],replyAttachmentId:a[40],replyAttachmentExtra:a[41],replyType:a[42],isForwarded:a[43],forwardScore:a[44],hasQuickReplies:a[45],adminMsgCtaId:a[46],adminMsgCtaTitle:a[47],adminMsgCtaType:a[48],cannotUnsendReason:a[49],textHasLinks:a[50],viewFlags:a[51],displayedContentTypes:a[52],viewedPluginKey:a[53],viewedPluginContext:a[54],quickReplyType:a[55],hotEmojiSize:a[56],platformXmdEncoded:a[57],replySourceTimestampMs:a[58],ephemeralDurationInSec:a[59],msUntilExpirationTs:a[60],ephemeralExpirationTs:a[61],takedownState:a[62],isCollapsed:a[63],subthreadKey:a[64],botResponseId:a[65],metadataDataclass:a[66],editCount:a[67],isPaidPartnership:a[68],adminSignatureName:a[69],adminSignatureProfileUrl:a[70],adminSignatureCreatorType:a[71]}):b.resolve())})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxUpsertMessageStoredProcedure";e.exports=a}),null);
__d("LSWriteThreadCapabilities",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return c[0]=b.i64.of_float(Date.now()),b.forEach(b.db.table(9).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({capabilities:a[1],capabilities2:a[2],capabilities3:a[3],capabilities4:a[4]})})},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxWriteThreadCapabilitiesStoredProcedure";e.exports=a}),null);/*FB_PKG_DELIM*/
__d("LSInsertAttachmentCta",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.db.table(19).add({ctaId:a[0],attachmentFbid:a[1],attachmentIndex:a[2],threadKey:a[3],messageId:a[5],title:a[6],type_:a[7],platformToken:a[8],actionUrl:a[9],nativeUrl:a[10],urlWebviewType:a[11],actionContentBlob:a[12],enableExtensions:a[13],extensionHeightType:a[14],targetId:a[15]})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxInsertAttachmentCtaStoredProcedure";e.exports=a}),null);
__d("LSInsertXmaAttachment",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.sequence([function(c){return b.forEach(b.filter(b.db.table(16).fetch([[[a[25],a[30],a[32]]]]),function(c){return b.i64.eq(c.threadKey,a[25])&&b.i64.eq(b.i64.cast([0,0]),a[26])&&c.messageId===a[30]&&c.attachmentFbid===a[32]&&b.i64.lt(c.authorityLevel,a[125])&&(b.i64.eq(c.attachmentType,b.i64.cast([0,7]))||b.i64.eq(c.attachmentType,b.i64.cast([0,0])))&&c.hasMedia===!1&&c.hasXma===!0&&b.i64.eq(c.ephemeralMediaState,void 0)}),function(a){return a["delete"]()})},function(c){return b.db.table(16).add({threadKey:a[25],messageId:a[30],attachmentFbid:a[32],filename:a[1],filesize:a[2],hasMedia:!1,isSharable:a[3],playableUrl:a[4],playableUrlFallback:a[5],playableUrlExpirationTimestampMs:a[6],playableUrlMimeType:a[7],previewUrl:a[8],previewUrlFallback:a[9],previewUrlExpirationTimestampMs:a[10],previewUrlMimeType:a[11],previewWidth:a[13],previewHeight:a[14],attributionAppId:a[15],attributionAppName:a[16],attributionAppIcon:a[17],attributionAppIconFallback:a[18],attributionAppIconUrlExpirationTimestampMs:a[19],attachmentIndex:a[20],accessibilitySummaryText:a[21],shouldRespectServerPreviewSize:a[22],subtitleIconUrl:a[23],shouldAutoplayVideo:a[24],attachmentType:a[27],timestampMs:a[29],offlineAttachmentId:a[31],hasXma:!0,xmaLayoutType:a[33],xmasTemplateType:a[34],collapsibleId:a[35],defaultCtaId:a[36],defaultCtaTitle:a[37],defaultCtaType:a[38],attachmentCta1Id:a[40],cta1Title:a[41],cta1IconType:a[42],cta1Type:a[43],attachmentCta2Id:a[45],cta2Title:a[46],cta2IconType:a[47],cta2Type:a[48],attachmentCta3Id:a[50],cta3Title:a[51],cta3IconType:a[52],cta3Type:a[53],imageUrl:a[54],imageUrlFallback:a[55],imageUrlExpirationTimestampMs:a[56],actionUrl:a[57],titleText:a[58],subtitleText:a[59],subtitleDecorationType:a[60],maxTitleNumOfLines:a[61],maxSubtitleNumOfLines:a[62],descriptionText:a[63],sourceText:a[64],faviconUrl:a[65],faviconUrlFallback:a[66],faviconUrlExpirationTimestampMs:a[67],listItemsId:a[69],listItemsDescriptionText:a[70],listItemsDescriptionSubtitleText:a[71],listItemsSecondaryDescriptionText:a[72],listItemId1:a[73],listItemTitleText1:a[74],listItemContactUrlList1:a[75],listItemProgressBarFilledPercentage1:a[76],listItemContactUrlExpirationTimestampList1:a[77],listItemContactUrlFallbackList1:a[78],listItemAccessibilityText1:a[79],listItemTotalCount1:a[80],listItemId2:a[81],listItemTitleText2:a[82],listItemContactUrlList2:a[83],listItemProgressBarFilledPercentage2:a[84],listItemContactUrlExpirationTimestampList2:a[85],listItemContactUrlFallbackList2:a[86],listItemAccessibilityText2:a[87],listItemTotalCount2:a[88],listItemId3:a[89],listItemTitleText3:a[90],listItemContactUrlList3:a[91],listItemProgressBarFilledPercentage3:a[92],listItemContactUrlExpirationTimestampList3:a[93],listItemContactUrlFallbackList3:a[94],listItemAccessibilityText3:a[95],listItemTotalCount3:a[96],isBorderless:a[100],headerImageUrlMimeType:a[101],headerTitle:a[102],headerSubtitleText:a[103],headerImageUrl:a[104],headerImageUrlFallback:a[105],headerImageUrlExpirationTimestampMs:a[106],previewImageDecorationType:a[107],shouldHighlightHeaderTitleInTitle:a[108],targetId:a[109],attachmentLoggingType:a[112],previewUrlLarge:a[114],gatingType:a[115],gatingTitle:a[116],targetExpiryTimestampMs:a[117],countdownTimestampMs:a[118],shouldBlurSubattachments:a[119],verifiedType:a[120],captionBodyText:a[121],isPublicXma:a[122],replyCount:a[123],previewOverlayCountdownExpiry:a[124],authorityLevel:a[125]})}])},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxInsertXmaAttachmentStoredProcedure";e.exports=a}),null);
__d("LSSetMessageTextHasLinks",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.filter(b.db.table(12).fetch([[[a[0],a[2],a[1]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(c.timestampMs,a[2])&&c.messageId===a[1]}),function(a){var b=a.update;a.item;return b({textHasLinks:!0})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxSetMessageTextHasLinksStoredProcedure";e.exports=a}),null);
__d("LSUpdateAttachmentCtaAtIndexIgnoringAuthority",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.i64.eq(a[6],b.i64.cast([0,0]))?b.forEach(b.db.table(16).fetch([[[a[0],a[1],a[2]]]]),function(b){var c=b.update;b.item;return c({defaultCtaId:a[3],defaultCtaTitle:a[4],defaultCtaType:a[5]})}):b.i64.eq(a[6],b.i64.cast([0,1]))?b.forEach(b.db.table(16).fetch([[[a[0],a[1],a[2]]]]),function(b){var c=b.update;b.item;return c({attachmentCta1Id:a[3],cta1Title:a[4],cta1Type:a[5],cta1IconType:void 0})}):b.i64.eq(a[6],b.i64.cast([0,2]))?b.forEach(b.db.table(16).fetch([[[a[0],a[1],a[2]]]]),function(b){var c=b.update;b.item;return c({attachmentCta2Id:a[3],cta2Title:a[4],cta2Type:a[5],cta2IconType:void 0})}):b.i64.eq(a[6],b.i64.cast([0,3]))?b.forEach(b.db.table(16).fetch([[[a[0],a[1],a[2]]]]),function(b){var c=b.update;b.item;return c({attachmentCta3Id:a[3],cta3Title:a[4],cta3Type:a[5],cta3IconType:void 0})}):b.resolve(function(a){b.logger(a).warn(a)}("Unexpected CTA index"))},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxUpdateAttachmentCtaAtIndexIgnoringAuthorityStoredProcedure";e.exports=a}),null);
__d("LSUpdateAttachmentItemCtaAtIndex",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.i64.eq(a[5],b.i64.cast([0,0]))?b.forEach(b.db.table(18).fetch([[[a[0],a[1]]]]),function(b){var c=b.update;b.item;return c({defaultCtaId:a[2],defaultCtaTitle:a[3],defaultCtaType:a[4]})}):b.i64.eq(a[5],b.i64.cast([0,1]))?b.forEach(b.db.table(18).fetch([[[a[0],a[1]]]]),function(b){var c=b.update;b.item;return c({attachmentCta1Id:a[2],cta1Title:a[3],cta1Type:a[4],cta1IconType:void 0})}):b.i64.eq(a[5],b.i64.cast([0,2]))?b.forEach(b.db.table(18).fetch([[[a[0],a[1]]]]),function(b){var c=b.update;b.item;return c({attachmentCta2Id:a[2],cta2Title:a[3],cta2Type:a[4],cta2IconType:void 0})}):b.i64.eq(a[5],b.i64.cast([0,3]))?b.forEach(b.db.table(18).fetch([[[a[0],a[1]]]]),function(b){var c=b.update;b.item;return c({attachmentCta3Id:a[2],cta3Title:a[3],cta3Type:a[4],cta3IconType:void 0})}):b.resolve(function(a){b.logger(a).warn(a)}("Unexpected CTA index"))},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxUpdateAttachmentItemCtaAtIndexStoredProcedure";e.exports=a}),null);/*FB_PKG_DELIM*/
__d("GeoPrivateMakeComponent",["cr:1641505","emptyFunction","react"],(function(a,b,c,d,e,f,g){"use strict";var h;h||d("react");c("emptyFunction")(b("cr:1641505"));function a(a,b){b.displayName==null&&(b.displayName=a);return b}g.makeGeoComponent=a}),98);
__d("LSFetchBanners",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("thread_key",a[0]),d[1]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTask"),"in_thread_banner_fetch_activity_banners_queue",c.i64.cast([0,72]),d[1],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(a){return c.resolve(e)}])}a.__sproc_name__="LSInThreadBannerFetchBannersStoredProcedure";e.exports=a}),null);
__d("LSGetFirstAvailableAttachmentCTAID",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(a){return b.sequence([function(a){return b.db.table(19).fetchDesc().next().then(function(a,d){var e=a.done;a=a.value;return e?c[0]=b.i64.cast([0,1]):(d=a.item,c[0]=b.i64.add(d.ctaId,b.i64.cast([0,1])))})},function(a){return d[0]=c[0]}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxGetFirstAvailableAttachmentCTAIDStoredProcedure";e.exports=a}),null);
__d("LSInsertAttachmentItem",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.db.table(18).add({attachmentFbid:a[0],attachmentIndex:a[1],threadKey:a[2],messageId:a[4],defaultActionEnableExtensions:a[30],originalPageSenderId:a[7],titleText:a[8],subtitleText:a[9],playableUrl:a[12],playableUrlFallback:a[13],playableUrlExpirationTimestampMs:a[14],playableUrlMimeType:a[15],dashManifest:a[16],previewUrl:a[17],previewUrlFallback:a[18],previewUrlExpirationTimestampMs:a[19],previewUrlMimeType:a[20],previewWidth:a[21],previewHeight:a[22],imageUrl:a[23],defaultCtaId:a[24],defaultCtaTitle:a[25],defaultCtaType:a[26],defaultButtonType:a[28],defaultActionUrl:a[29],defaultWebviewHeightRatio:a[32],attachmentCta1Id:a[34],cta1Title:a[35],cta1IconType:a[36],cta1Type:a[37],attachmentCta2Id:a[39],cta2Title:a[40],cta2IconType:a[41],cta2Type:a[42],attachmentCta3Id:a[44],cta3Title:a[45],cta3IconType:a[46],cta3Type:a[47],faviconUrl:a[48],faviconUrlFallback:a[49],faviconUrlExpirationTimestampMs:a[50],previewUrlLarge:a[51]})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxInsertAttachmentItemStoredProcedure";e.exports=a}),null);
__d("LSWriteCTAIdToThreadsTable",["LSGetFirstAvailableAttachmentCTAID"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return a[1]===void 0?c.forEach(c.filter(c.db.table(9).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.threadKey,a[0])&&(c.i64.neq(b.lastMessageCtaId,void 0)||b.lastMessageCtaType!==void 0)}),function(b){var c=b.update;b.item;return c({lastMessageCtaId:void 0,lastMessageCtaType:void 0,lastMessageCtaTimestampMs:a[2]})}):c.i64.neq(a[2],void 0)?c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[0]=c.i64.cast([0,0]):(b=a.item,d[0]=b.lastActivityTimestampMs)})},function(e){return c.i64.ge(a[2],d[0])?c.sequence([function(a){return c.storedProcedure(b("LSGetFirstAvailableAttachmentCTAID")).then(function(a){return a=a,d[2]=a[0],a})},function(b){return c.forEach(c.db.table(9).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({lastMessageCtaId:d[2],lastMessageCtaType:a[1],lastMessageCtaTimestampMs:a[2]})})}]):c.resolve(0)}]):c.resolve()},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxWriteCTAIdToThreadsTableStoredProcedure";e.exports=a}),null);
__d("XCometCommunityThreadsControllerRouteBuilder",["jsExtraRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsExtraRouteBuilder")("/messages/c/{folder_id}/t/{thread_key}/",Object.freeze({}),["/messages/c/{folder_id}/"],void 0);b=a;g["default"]=b}),98);
__d("XMessengerDotComCometCommunityThreadsControllerRouteBuilder",["jsExtraRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsExtraRouteBuilder")("/c/{folder_id}/t/{thread_key}/",Object.freeze({}),["/c/{folder_id}/"],void 0);b=a;g["default"]=b}),98);
__d("MWInboxCommunityThreadsRouteBuilder",["CurrentEnvironment","XCometCommunityThreadsControllerRouteBuilder","XMessengerDotComCometCommunityThreadsControllerRouteBuilder"],(function(a,b,c,d,e,f,g){"use strict";a=c("CurrentEnvironment").facebookdotcom?{buildUriForMessage:function(a){var b=a.folder_id;a=a.thread_key;return c("XCometCommunityThreadsControllerRouteBuilder").buildUri({folder_id:b,thread_key:a})},buildURL:function(a){var b=a.folder_id;a=a.thread_key;return c("XCometCommunityThreadsControllerRouteBuilder").buildURL({folder_id:b,thread_key:a})},buildURLWithoutThread:function(a){a=a.folder_id;return c("XCometCommunityThreadsControllerRouteBuilder").buildExtraURL("/messages/c/{folder_id}/",{folder_id:a})}}:{buildUriForMessage:function(a){var b=a.folder_id;a=a.thread_key;return c("XMessengerDotComCometCommunityThreadsControllerRouteBuilder").buildUri({folder_id:b,thread_key:a})},buildURL:function(a){var b=a.folder_id;a=a.thread_key;return c("XMessengerDotComCometCommunityThreadsControllerRouteBuilder").buildURL({folder_id:b,thread_key:a})},buildURLWithoutThread:function(a){a=a.folder_id;return c("XMessengerDotComCometCommunityThreadsControllerRouteBuilder").buildExtraURL("/c/{folder_id}/",{folder_id:a})}};b=a.buildURL;d=a.buildURLWithoutThread;g.buildURL=b;g.buildURLWithoutThread=d}),98);
__d("XGroupsC4GThreadViewControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/groups/{idorvanity}/chats/{thread_id}/",Object.freeze({}),void 0);b=a;g["default"]=b}),98);
__d("isFalsey",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a==null||!Boolean(a)}f["default"]=a}),66);/*FB_PKG_DELIM*/
__d("LSGetFirstAvailableThreadNullstateCTAID",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(a){return b.sequence([function(a){return b.db.table(29).fetchDesc().next().then(function(a,d){var e=a.done;a=a.value;return e?c[0]=b.i64.cast([0,1]):(d=a.item,c[0]=b.i64.add(d.ctaId,b.i64.cast([0,1])))})},function(a){return d[0]=c[0]}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxGetFirstAvailableThreadNullstateCTAIDStoredProcedure";e.exports=a}),null);
__d("LSGetFirstAvailableThreadNullstateCTAIDForThreadKey",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.db.table(29).fetch([[[a[0]]],"threadKeyCtaId"]).next().then(function(a,b){var d=a.done;a=a.value;return d?c[0]=void 0:(b=a.item,c[0]=b.ctaId)})},function(a){return d[0]=c[0]}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxGetFirstAvailableThreadNullstateCTAIDForThreadKeyStoredProcedure";e.exports=a}),null);
__d("LSInsertIcebreakerData",["LSArrayGetObjectAt","LSGetFirstAvailableThreadNullstateCTAID","LSGetFirstAvailableThreadNullstateCTAIDForThreadKey"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return c.storedProcedure(b("LSGetFirstAvailableThreadNullstateCTAIDForThreadKey"),a[0]).then(function(a){return a=a,d[0]=a[0],a})},function(e){return c.i64.eq(d[0],void 0)?c.sequence([function(a){return c.storedProcedure(b("LSGetFirstAvailableThreadNullstateCTAID")).then(function(a){return a=a,d[1]=a[0],a})},function(e){return d[2]=c.createArray(),d[3]=c.i64.of_int32(a[1].length),c.i64.gt(d[3],c.i64.cast([0,0]))?c.loopAsync(d[3],function(e){return d[7]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[1],d[7]).then(function(a){return a=a,d[8]=a[0],d[9]=a[1],a})},function(a){return d[10]=d[8].get("thread_key"),d[8],d[11]=(d[2].push(d[10]),d[2])}])}):c.resolve()},function(a){return d[4]=new c.Map(),c.sequence([function(a){return d[7]=c.createArray(),d[8]=c.i64.of_int32(d[2].length),c.i64.gt(d[8],c.i64.cast([0,0]))?c.loopAsync(d[8],function(a){return d[10]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[2],d[10]).then(function(a){return a=a,d[11]=a[0],d[12]=a[1],a})},function(a){return d[13]=(d[7].push(c.i64.to_string(d[11])),d[7])}])}):c.resolve()},function(a){return d[9]=d[7].join(","),d[5]=d[9]}])},function(a){return c.forEach(c.filter(c.db.table(28).fetch(),function(a){return d[2].some(function(b){return c.i64.eq(a.threadKey,b)})}),function(a){a=a.item;return d[4].set(c.i64.to_string(a.threadKey),!0)})},function(e){return d[6]=c.i64.of_int32(a[1].length),c.i64.gt(d[6],c.i64.cast([0,0]))?c.loopAsync(d[6],function(e){return d[7]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[1],d[7]).then(function(a){return a=a,d[8]=a[0],d[9]=a[1],a})},function(a){return d[12]=c.i64.add(d[1],d[7]),d[10]=d[8].get("thread_key"),d[8],d[11]=d[4].get(c.i64.to_string(d[10])),d[4],d[11]!==void 0?c.db.table(29).fetch([[[d[12]]]]).next().then(function(a){var b=a.done;a.value;return b?(d[13]=d[8].get("thread_key"),d[8],d[14]=d[8].get("title"),d[8],d[15]=d[8].get("cta_type"),d[8],d[16]=d[8].get("platform_token"),d[8],d[17]=d[8].get("cta_identifier"),d[8],c.db.table(29).add({ctaId:d[12],threadKey:d[13],title:d[14],ctaType:d[15],platformToken:d[16],ctaIdentifier:d[17]})):0}):c.resolve()}])}):c.resolve()}]):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxInsertIcebreakerDataStoredProcedure";e.exports=a}),null);
__d("LSIssueInsertPersistentMenuCtasForThreadTask",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("thread_key",a[0]),d[1]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTask"),"insert_persistent_menu_ctas",c.i64.cast([0,54]),d[1],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(a){return c.resolve(e)}])}a.__sproc_name__="LSComposerMenusIssueInsertPersistentMenuCtasForThreadTaskStoredProcedure";e.exports=a}),null);
__d("LSIssueInsertPersistentMenuItemsForThreadTask",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("thread_key",a[0]),d[1]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTask"),"insert_persistent_menu_items",c.i64.cast([0,117]),d[1],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(a){return c.resolve(e)}])}a.__sproc_name__="LSOmnistoreSettingsIssueInsertPersistentMenuItemsForThreadTaskStoredProcedure";e.exports=a}),null);
__d("LSVerifyCustomCommandsExist",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.db.table(296).fetch([[[a[0]]]]).next().then(function(e,f){f=e.done;e=e.value;return f?(d[1]=new c.Map(),d[1].set("thread_key",a[0]),d[2]=c.toJSON(d[1]),c.storedProcedure(b("LSIssueNewTask"),"fetch_custom_thread_commands",c.i64.cast([0,767]),d[2],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))):(e.item,0)})},function(a){return c.resolve(e)}])}a.__sproc_name__="LSOmnistoreSettingsVerifyCustomCommandsExistStoredProcedure";e.exports=a}),null);/*FB_PKG_DELIM*/
__d("LSInsertBlobAttachment",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.sequence([function(c){return b.forEach(b.filter(b.db.table(16).fetch([[[a[27],a[32],a[34]]]]),function(c){return b.i64.eq(c.threadKey,a[27])&&b.i64.eq(b.i64.cast([0,0]),a[28])&&c.messageId===a[32]&&c.attachmentFbid===a[34]&&b.i64.lt(c.authorityLevel,a[48])&&(b.i64.eq(c.attachmentType,b.i64.cast([0,2]))||b.i64.eq(c.attachmentType,b.i64.cast([0,3]))||b.i64.eq(c.attachmentType,b.i64.cast([0,4]))||b.i64.eq(c.attachmentType,b.i64.cast([0,5]))||b.i64.eq(c.attachmentType,b.i64.cast([0,6]))||b.i64.eq(c.attachmentType,b.i64.cast([0,10]))||b.i64.eq(c.attachmentType,b.i64.cast([0,14])))&&b.i64.eq(c.ephemeralMediaState,void 0)&&c.isSharable===!1}),function(a){return a["delete"]()})},function(c){return b.db.table(16).add({threadKey:a[27],messageId:a[32],attachmentFbid:a[34],filename:a[0],filesize:a[1],hasMedia:a[2],isSharable:!1,playableUrl:a[3],playableUrlFallback:a[4],playableUrlExpirationTimestampMs:a[5],playableUrlMimeType:a[6],dashManifest:a[7],previewUrl:a[8],previewUrlFallback:a[9],previewUrlExpirationTimestampMs:a[10],previewUrlMimeType:a[11],miniPreview:a[13],previewWidth:a[14],previewHeight:a[15],attributionAppId:a[16],attributionAppName:a[17],attributionAppIcon:a[18],attributionAppIconFallback:a[19],attributionAppIconUrlExpirationTimestampMs:a[20],localPlayableUrl:a[21],playableDurationMs:a[22],attachmentIndex:a[23],accessibilitySummaryText:a[24],isPreviewImage:a[25],originalFileHash:a[26],attachmentType:a[29],timestampMs:a[31],offlineAttachmentId:a[33],hasXma:a[35],xmaLayoutType:a[36],xmasTemplateType:a[37],titleText:a[38],subtitleText:a[39],descriptionText:a[40],sourceText:a[41],faviconUrlExpirationTimestampMs:a[42],isBorderless:a[44],previewUrlLarge:a[45],samplingFrequencyHz:a[46],waveformData:a[47],authorityLevel:a[48]})}])},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxInsertBlobAttachmentStoredProcedure";e.exports=a}),null);
__d("LSInsertStickerAttachment",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.sequence([function(c){return b.forEach(b.filter(b.db.table(16).fetch([[[a[14],a[18],a[19]]]]),function(c){return b.i64.eq(c.threadKey,a[14])&&b.i64.eq(b.i64.cast([0,0]),a[15])&&c.messageId===a[18]&&c.attachmentFbid===a[19]&&b.i64.lt(c.authorityLevel,a[31])&&b.i64.eq(c.attachmentType,b.i64.cast([0,1]))&&c.hasMedia===!0&&c.hasXma===!1&&b.i64.eq(c.ephemeralMediaState,void 0)&&c.isSharable===!1}),function(a){return a["delete"]()})},function(c){return b.db.table(16).add({threadKey:a[14],messageId:a[18],attachmentFbid:a[19],hasMedia:!0,isSharable:!1,playableUrl:a[0],playableUrlFallback:a[1],playableUrlExpirationTimestampMs:a[2],playableUrlMimeType:a[3],previewUrl:a[4],previewUrlFallback:a[5],previewUrlExpirationTimestampMs:a[6],previewUrlMimeType:a[7],previewWidth:a[9],previewHeight:a[10],imageUrlMimeType:a[11],attachmentIndex:a[12],accessibilitySummaryText:a[13],attachmentType:b.i64.cast([0,1]),timestampMs:a[17],hasXma:!1,imageUrl:a[20],imageUrlFallback:a[21],imageUrlExpirationTimestampMs:a[22],faviconUrlExpirationTimestampMs:a[23],avatarViewSize:a[25],avatarCount:a[26],targetId:a[27],mustacheText:a[30],authorityLevel:a[31]})}])},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxInsertStickerAttachmentStoredProcedure";e.exports=a}),null);